Original code is O(n^2)